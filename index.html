<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>تاريخ الدول العربية | وثيقة التطبيع</title>
  <meta name="description" content="وثيقة تفاعلية توثيقية شاملة لمواقف الدول العربية من الكيان الصهيوني وقضية فلسطين.">
  
  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>
  
  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@300;400;500;700;900&display=swap" rel="stylesheet">

  <style>
    :root {
      --bg: #050505;
      --bg-card: #0a0a0a;
      --fg: #ffffff;
      --muted: #888888;
      --accent: #149954;
      --accent-red: #E4312B;
      --accent-gold: #D4AF37;
      --accent-black: #000000;
      --accent-white: #ffffff;
      --accent-purple: #8A2BE2;
      --accent-blue: #2563eb;
      --border: #1a1a1a;
      --palestine-green: #149954;
      --palestine-red: #E4312B;
      --palestine-black: #000000;
      --palestine-white: #ffffff;
    }

    * { margin: 0; padding: 0; box-sizing: border-box; }

    body {
      font-family: 'Tajawal', sans-serif;
      background-color: var(--bg);
      color: var(--fg);
      overflow-x: hidden;
      line-height: 1.6;
    }

    /* Palestine Flag Gradient Background */
    .palestine-gradient {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 6px;
      background: linear-gradient(90deg, 
        var(--palestine-black) 0%, 
        var(--palestine-black) 25%, 
        var(--palestine-white) 25%, 
        var(--palestine-white) 50%, 
        var(--palestine-green) 50%, 
        var(--palestine-green) 75%, 
        var(--palestine-red) 75%, 
        var(--palestine-red) 100%
      );
      z-index: 9999;
      animation: flagPulse 3s ease-in-out infinite;
    }

    @keyframes flagPulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.7; }
    }

    /* Animated Background */
    .bg-animation {
      position: fixed;
      inset: 0;
      z-index: -3;
      background: 
        radial-gradient(ellipse at 20% 20%, rgba(20, 153, 84, 0.15) 0%, transparent 50%),
        radial-gradient(ellipse at 80% 80%, rgba(228, 49, 43, 0.1) 0%, transparent 50%),
        radial-gradient(ellipse at 50% 50%, rgba(212, 175, 55, 0.05) 0%, transparent 70%);
      animation: bgMove 20s ease-in-out infinite;
    }

    @keyframes bgMove {
      0%, 100% { transform: scale(1) rotate(0deg); }
      50% { transform: scale(1.1) rotate(1deg); }
    }

    /* Keffiyeh Pattern Overlay */
    .keffiyeh-pattern {
      position: fixed;
      inset: 0;
      z-index: -2;
      opacity: 0.03;
      background-image: 
        repeating-linear-gradient(45deg, transparent, transparent 10px, rgba(255,255,255,0.03) 10px, rgba(255,255,255,0.03) 20px),
        repeating-linear-gradient(-45deg, transparent, transparent 10px, rgba(255,255,255,0.03) 10px, rgba(255,255,255,0.03) 20px);
      background-size: 30px 30px;
    }

    /* Grid Pattern */
    .bg-grid {
      position: fixed;
      inset: 0;
      z-index: -1;
      background-image: 
        linear-gradient(rgba(20, 153, 84, 0.05) 1px, transparent 1px),
        linear-gradient(90deg, rgba(20, 153, 84, 0.05) 1px, transparent 1px);
      background-size: 80px 80px;
      mask-image: radial-gradient(circle at 50% 30%, black 20%, transparent 70%);
      animation: gridPulse 8s ease-in-out infinite;
    }

    @keyframes gridPulse {
      0%, 100% { opacity: 0.6; }
      50% { opacity: 1; }
    }

    /* Floating Particles */
    .particles-container {
      position: fixed;
      inset: 0;
      z-index: -1;
      pointer-events: none;
      overflow: hidden;
    }

    .particle {
      position: absolute;
      border-radius: 50%;
      animation: float 15s infinite ease-in-out;
      opacity: 0.6;
    }

    .particle.green { background: radial-gradient(circle, var(--accent) 0%, transparent 70%); }
    .particle.red { background: radial-gradient(circle, var(--accent-red) 0%, transparent 70%); }
    .particle.gold { background: radial-gradient(circle, var(--accent-gold) 0%, transparent 70%); }

    @keyframes float {
      0%, 100% { 
        transform: translateY(100vh) rotate(0deg); 
        opacity: 0;
      }
      10% { opacity: 0.6; }
      90% { opacity: 0.6; }
      100% { 
        transform: translateY(-100vh) rotate(720deg); 
        opacity: 0;
      }
    }

    /* Glitch Effect */
    .glitch-wrapper { position: relative; display: inline-block; }
    
    .glitch-text {
      font-size: clamp(2.5rem, 10vw, 6rem);
      font-weight: 900;
      letter-spacing: -0.02em;
      text-transform: uppercase;
      position: relative;
      color: white;
      text-shadow: 
        0 0 20px rgba(20, 153, 84, 0.5),
        0 0 40px rgba(20, 153, 84, 0.3),
        0 0 60px rgba(20, 153, 84, 0.2);
    }

    .glitch-text::before,
    .glitch-text::after {
      content: attr(data-text);
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: var(--bg);
    }

    .glitch-text::before {
      left: 3px;
      text-shadow: -3px 0 var(--accent-red);
      clip: rect(44px, 450px, 56px, 0);
      animation: glitch-anim 4s infinite linear alternate-reverse;
    }

    .glitch-text::after {
      left: -3px;
      text-shadow: 3px 0 var(--accent);
      clip: rect(44px, 450px, 56px, 0);
      animation: glitch-anim2 4s infinite linear alternate-reverse;
    }

    @keyframes glitch-anim {
      0% { clip: rect(31px, 9999px, 94px, 0); }
      20% { clip: rect(85px, 9999px, 77px, 0); }
      40% { clip: rect(64px, 9999px, 98px, 0); }
      60% { clip: rect(99px, 9999px, 114px, 0); }
      80% { clip: rect(98px, 9999px, 129px, 0); }
      100% { clip: rect(82px, 9999px, 69px, 0); }
    }

    @keyframes glitch-anim2 {
      0% { clip: rect(65px, 9999px, 100px, 0); }
      20% { clip: rect(79px, 9999px, 85px, 0); }
      40% { clip: rect(88px, 9999px, 94px, 0); }
      60% { clip: rect(22px, 9999px, 63px, 0); }
      80% { clip: rect(69px, 9999px, 62px, 0); }
      100% { clip: rect(58px, 9999px, 94px, 0); }
    }

    /* News Ticker */
    .ticker-wrap {
      position: fixed;
      top: 6px;
      left: 0;
      width: 100%;
      overflow: hidden;
      background: linear-gradient(90deg, rgba(0,0,0,0.95), rgba(20,20,20,0.95), rgba(0,0,0,0.95));
      border-bottom: 1px solid var(--border);
      z-index: 50;
      font-size: 0.7rem;
      padding: 8px 0;
    }

    .ticker {
      display: flex;
      white-space: nowrap;
      animation: ticker 40s linear infinite;
    }

    .ticker-item {
      padding: 0 2rem;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .ticker-item::before {
      content: '';
      width: 6px;
      height: 6px;
      background: var(--accent);
      border-radius: 50%;
      animation: blink 1s infinite;
    }

    @keyframes ticker {
      0% { transform: translateX(0); }
      100% { transform: translateX(-100%); }
    }

    @keyframes blink {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.3; }
    }

    /* Flag Stripe Bottom */
    .flag-stripe {
      position: fixed;
      bottom: 0;
      left: 0;
      width: 100%;
      height: 5px;
      background: linear-gradient(90deg, 
        var(--palestine-black) 0%, 
        var(--palestine-black) 33%, 
        var(--palestine-white) 33%, 
        var(--palestine-white) 66%, 
        var(--palestine-green) 66%, 
        var(--palestine-green) 100%
      );
      z-index: 9999;
    }

    .flag-stripe::before {
      content: '';
      position: absolute;
      left: 0;
      top: 0;
      width: 20%;
      height: 100%;
      background: var(--palestine-red);
      clip-path: polygon(0 0, 100% 50%, 0 100%);
      animation: arrowPulse 2s ease-in-out infinite;
    }

    @keyframes arrowPulse {
      0%, 100% { transform: scaleX(1); }
      50% { transform: scaleX(1.1); }
    }

    /* Coffee Button */
    .coffee-button {
      position: fixed;
      top: 80px;
      left: 20px;
      z-index: 9999;
      background: linear-gradient(135deg, #1a1a1a, #2a2a2a);
      border: 1px solid var(--accent-gold);
      border-radius: 50px;
      padding: 14px 28px;
      display: flex;
      align-items: center;
      gap: 12px;
      cursor: pointer;
      box-shadow: 
        0 5px 30px rgba(0,0,0,0.5),
        0 0 20px rgba(212, 175, 55, 0.2),
        inset 0 1px 0 rgba(255,255,255,0.1);
      transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
      font-weight: 700;
      color: var(--accent-gold);
      backdrop-filter: blur(10px);
    }

    .coffee-button:hover {
      transform: translateY(-5px) scale(1.02);
      box-shadow: 
        0 15px 40px rgba(0,0,0,0.6),
        0 0 40px rgba(212, 175, 55, 0.4);
      background: linear-gradient(135deg, #2a2a2a, #3a3a3a);
    }

    .coffee-button svg {
      width: 22px;
      height: 22px;
      flex-shrink: 0;
      filter: drop-shadow(0 0 5px rgba(212, 175, 55, 0.5));
    }

    /* BTC Modal */
    .btc-modal-overlay {
      position: fixed;
      inset: 0;
      background: rgba(0, 0, 0, 0.95);
      backdrop-filter: blur(20px);
      z-index: 10000;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 1rem;
      opacity: 0;
      visibility: hidden;
      transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .btc-modal-overlay.active {
      opacity: 1;
      visibility: visible;
    }

    .btc-modal-content {
      background: linear-gradient(145deg, #0a0a0a, #151515);
      border: 2px solid var(--accent-gold);
      border-radius: 24px;
      max-width: 480px;
      width: 100%;
      padding: 3rem;
      text-align: center;
      box-shadow: 
        0 0 80px rgba(212, 175, 55, 0.3),
        0 25px 50px rgba(0,0,0,0.5);
      transform: scale(0.8) translateY(50px);
      transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1);
      position: relative;
      overflow: hidden;
    }

    .btc-modal-content::before {
      content: '';
      position: absolute;
      top: -50%;
      left: -50%;
      width: 200%;
      height: 200%;
      background: radial-gradient(circle, rgba(212, 175, 55, 0.1) 0%, transparent 50%);
      animation: rotateGlow 10s linear infinite;
    }

    @keyframes rotateGlow {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    .btc-modal-overlay.active .btc-modal-content {
      transform: scale(1) translateY(0);
    }

    .btc-address-box {
      background: #050505;
      border: 1px solid var(--accent-gold);
      border-radius: 16px;
      padding: 1.5rem;
      margin: 1.5rem 0;
      font-family: 'Courier New', monospace;
      font-size: 0.85rem;
      color: var(--accent-gold);
      word-break: break-all;
      direction: ltr;
      position: relative;
      box-shadow: inset 0 2px 10px rgba(0,0,0,0.5);
    }

    .btc-address-box::before {
      content: '₿';
      position: absolute;
      top: -14px;
      right: 20px;
      background: linear-gradient(135deg, var(--accent-gold), #b8962d);
      color: #000;
      width: 32px;
      height: 32px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.2rem;
      font-weight: bold;
      box-shadow: 0 0 20px rgba(212, 175, 55, 0.5);
    }

    .copy-btn {
      background: linear-gradient(135deg, var(--accent-gold), #b8962d);
      border: none;
      color: #000;
      padding: 14px 50px;
      border-radius: 50px;
      font-weight: 800;
      cursor: pointer;
      transition: all 0.3s ease;
      font-size: 1rem;
      position: relative;
      overflow: hidden;
    }

    .copy-btn::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
      transition: left 0.5s ease;
    }

    .copy-btn:hover::before {
      left: 100%;
    }

    .copy-btn:hover {
      transform: scale(1.05);
      box-shadow: 0 0 30px rgba(212, 175, 55, 0.5);
    }

    .close-btc-modal {
      position: absolute;
      top: 15px;
      left: 15px;
      background: rgba(255,255,255,0.1);
      border: none;
      color: #666;
      font-size: 1.5rem;
      cursor: pointer;
      transition: all 0.3s ease;
      width: 40px;
      height: 40px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .close-btc-modal:hover {
      color: white;
      background: var(--accent-red);
    }

    .copy-notification {
      position: fixed;
      bottom: 30px;
      left: 50%;
      transform: translateX(-50%);
      background: linear-gradient(135deg, var(--accent), #0d7a43);
      color: white;
      padding: 16px 32px;
      border-radius: 50px;
      font-size: 1rem;
      font-weight: 700;
      z-index: 10001;
      box-shadow: 0 10px 40px rgba(20, 153, 84, 0.4);
      animation: slideUp 2s ease forwards;
    }

    @keyframes slideUp {
      0% { opacity: 0; transform: translate(-50%, 30px); }
      15% { opacity: 1; transform: translate(-50%, 0); }
      85% { opacity: 1; transform: translate(-50%, 0); }
      100% { opacity: 0; transform: translate(-50%, -20px); }
    }

    /* Level Sections */
    .level-section {
      position: relative;
      border: 1px solid var(--border);
      background: linear-gradient(145deg, rgba(15,15,15,0.8), rgba(5,5,5,0.9));
      backdrop-filter: blur(20px);
      margin-bottom: 4rem;
      overflow: hidden;
      border-radius: 16px;
      transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .level-section::before {
      content: '';
      position: absolute;
      top: 0;
      right: 0;
      width: 4px;
      height: 100%;
      transition: all 0.4s ease;
    }

    .level-section:hover {
      transform: translateY(-5px);
      box-shadow: 0 25px 50px rgba(0,0,0,0.4);
    }

    .level-section:hover::before {
      width: 8px;
      box-shadow: 0 0 30px currentColor;
    }

    .level-1::before { background: linear-gradient(180deg, #059669, #10b981); color: #059669; }
    .level-2::before { background: linear-gradient(180deg, #0891b2, #06b6d4); color: #0891b2; }
    .level-3::before { background: linear-gradient(180deg, #d97706, #f59e0b); color: #d97706; }
    .level-4::before { background: linear-gradient(180deg, #2563eb, #3b82f6); color: #2563eb; }
    .level-5::before { background: linear-gradient(180deg, #dc2626, #ef4444); color: #dc2626; }

    /* Country Cards */
    .country-card {
      background: linear-gradient(145deg, rgba(20, 20, 20, 0.6), rgba(10, 10, 10, 0.8));
      border: 1px solid rgba(255,255,255,0.05);
      padding: 2rem;
      cursor: pointer;
      transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
      position: relative;
      overflow: hidden;
      height: 100%;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
      border-radius: 12px;
    }

    .country-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(135deg, transparent 0%, rgba(20, 153, 84, 0.05) 100%);
      opacity: 0;
      transition: opacity 0.4s ease;
    }

    .country-card:hover {
      border-color: rgba(20, 153, 84, 0.3);
      transform: translateY(-10px) scale(1.02);
      box-shadow: 
        0 20px 40px rgba(0, 0, 0, 0.4),
        0 0 30px rgba(20, 153, 84, 0.1);
    }

    .country-card:hover::before {
      opacity: 1;
    }

    .country-card:hover::after {
      opacity: 1;
      transform: translateY(0);
    }

    .country-card::after {
      content: 'FREE PALESTINE';
      position: absolute;
      bottom: 0;
      left: 0;
      width: 100%;
      text-align: center;
      font-size: 0.65rem;
      letter-spacing: 0.15em;
      padding: 8px 0;
      background: linear-gradient(90deg, var(--accent), var(--accent-red));
      color: white;
      font-weight: 900;
      opacity: 0;
      transform: translateY(100%);
      transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
    }

    /* Palestine Section */
    .palestine-section {
      position: relative;
      border: 2px solid rgba(212, 175, 55, 0.4);
      background: linear-gradient(145deg, rgba(20, 153, 84, 0.08), rgba(10,10,10,0.95));
      backdrop-filter: blur(20px);
      margin-top: 8rem;
      margin-bottom: 4rem;
      overflow: hidden;
      border-radius: 20px;
    }

    .palestine-section::before {
      content: '';
      position: absolute;
      top: 0;
      right: 0;
      width: 8px;
      height: 100%;
      background: linear-gradient(180deg, var(--accent-gold), var(--accent-red), var(--accent));
      box-shadow: 0 0 40px rgba(212, 175, 55, 0.5);
    }

    .palestine-card {
      background: linear-gradient(145deg, rgba(20, 20, 20, 0.7), rgba(5, 5, 5, 0.9));
      border: 1px solid rgba(212, 175, 55, 0.3);
      padding: 3rem;
      cursor: pointer;
      transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
      position: relative;
      overflow: hidden;
      min-height: 220px;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      text-align: center;
      border-radius: 16px;
    }

    .palestine-card:hover {
      border-color: var(--accent-gold);
      transform: translateY(-10px) scale(1.02);
      box-shadow: 0 30px 60px rgba(212, 175, 55, 0.2);
    }

    .palestine-card:hover::after {
      opacity: 1;
      transform: translateY(0);
    }

    .palestine-card::after {
      content: 'THE CORE OF THE CAUSE';
      position: absolute;
      bottom: 0;
      left: 0;
      width: 100%;
      text-align: center;
      font-size: 0.7rem;
      letter-spacing: 0.2em;
      padding: 8px 0;
      background: linear-gradient(90deg, var(--accent-gold), #b8962d);
      color: black;
      font-weight: 900;
      opacity: 0;
      transform: translateY(100%);
      transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
    }

    /* Sovereignty Section */
    .sovereignty-section {
      position: relative;
      border: 2px solid rgba(138, 43, 226, 0.4);
      background: linear-gradient(145deg, rgba(30, 10, 40, 0.8), rgba(10,10,10,0.95));
      backdrop-filter: blur(20px);
      margin-top: 4rem;
      margin-bottom: 4rem;
      overflow: hidden;
      border-radius: 20px;
    }

    .sovereignty-section::before {
      content: '';
      position: absolute;
      top: 0;
      right: 0;
      width: 8px;
      height: 100%;
      background: linear-gradient(180deg, var(--accent-purple), var(--accent-red), #ff7b89);
      box-shadow: 0 0 40px rgba(138, 43, 226, 0.5);
    }

    .sovereignty-card {
      background: linear-gradient(145deg, rgba(40, 15, 50, 0.7), rgba(15, 5, 20, 0.9));
      border: 1px solid rgba(138, 43, 226, 0.3);
      padding: 3rem;
      cursor: pointer;
      transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
      position: relative;
      overflow: hidden;
      min-height: 220px;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      text-align: center;
      border-radius: 16px;
    }

    .sovereignty-card:hover {
      border-color: var(--accent-purple);
      transform: translateY(-10px) scale(1.02);
      box-shadow: 0 30px 60px rgba(138, 43, 226, 0.3);
    }

    .sovereignty-card:hover::after {
      opacity: 1;
      transform: translateY(0);
    }

    .sovereignty-card::after {
      content: 'ثمن السلام: استقلال أم تبعية؟';
      position: absolute;
      bottom: 0;
      left: 0;
      width: 100%;
      text-align: center;
      font-size: 0.7rem;
      letter-spacing: 0.1em;
      padding: 8px 0;
      background: linear-gradient(90deg, var(--accent-purple), #b84c6c);
      color: white;
      font-weight: 900;
      opacity: 0;
      transform: translateY(100%);
      transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
    }

    /* External Actors Section (America & ISIS) */
    .external-section {
      position: relative;
      border: 2px solid rgba(107, 114, 128, 0.4);
      background: linear-gradient(145deg, rgba(20, 20, 25, 0.8), rgba(10,10,10,0.95));
      backdrop-filter: blur(20px);
      margin-top: 4rem;
      margin-bottom: 4rem;
      overflow: hidden;
      border-radius: 20px;
    }

    .external-section::before {
      content: '';
      position: absolute;
      top: 0;
      right: 0;
      width: 8px;
      height: 100%;
      background: linear-gradient(180deg, #6b7280, #374151, #4b5563);
      box-shadow: 0 0 40px rgba(107, 114, 128, 0.3);
    }

    .external-card {
      background: linear-gradient(145deg, rgba(30, 30, 35, 0.7), rgba(15, 15, 20, 0.9));
      border: 1px solid rgba(107, 114, 128, 0.3);
      padding: 3rem;
      cursor: pointer;
      transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
      position: relative;
      overflow: hidden;
      min-height: 220px;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      text-align: center;
      border-radius: 16px;
    }

    .external-card:hover {
      border-color: #9ca3af;
      transform: translateY(-10px) scale(1.02);
      box-shadow: 0 30px 60px rgba(107, 114, 128, 0.2);
    }

    .external-card:hover::after {
      opacity: 1;
      transform: translateY(0);
    }

    .external-card::after {
      content: 'تأثير خارجي';
      position: absolute;
      bottom: 0;
      left: 0;
      width: 100%;
      text-align: center;
      font-size: 0.7rem;
      letter-spacing: 0.15em;
      padding: 8px 0;
      background: linear-gradient(90deg, #4b5563, #6b7280);
      color: white;
      font-weight: 900;
      opacity: 0;
      transform: translateY(100%);
      transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
    }

    /* Evidence Section */
    .evidence-section {
      position: relative;
      border: 2px solid rgba(37, 99, 235, 0.4);
      background: linear-gradient(145deg, rgba(0, 20, 40, 0.7), rgba(10,10,10,0.9));
      backdrop-filter: blur(20px);
      margin-top: 4rem;
      margin-bottom: 4rem;
      overflow: hidden;
      border-radius: 16px;
    }

    .evidence-section::before {
      content: '';
      position: absolute;
      top: 0;
      right: 0;
      width: 6px;
      height: 100%;
      background: linear-gradient(180deg, var(--accent-blue), #60a5fa);
      box-shadow: 0 0 40px rgba(37, 99, 235, 0.5);
    }

    .evidence-table {
      width: 100%;
      border-collapse: collapse;
      font-size: 0.8rem;
    }

    .evidence-table th {
      background: linear-gradient(180deg, rgba(0, 0, 0, 0.8), rgba(0, 0, 0, 0.6));
      color: var(--accent-blue);
      font-weight: 700;
      padding: 1rem 0.75rem;
      border-bottom: 2px solid rgba(37, 99, 235, 0.5);
      text-align: center;
      text-transform: uppercase;
      letter-spacing: 0.1em;
    }

    .evidence-table td {
      padding: 1rem 0.75rem;
      border-bottom: 1px solid rgba(255,255,255,0.05);
      vertical-align: top;
      transition: background 0.3s ease;
    }

    .evidence-table tr:hover td {
      background: rgba(37, 99, 235, 0.1);
    }

    .evidence-table a {
      color: #93c5fd;
      text-decoration: none;
      border-bottom: 1px dashed #3b82f6;
      transition: all 0.3s ease;
    }

    .evidence-table a:hover {
      color: white;
      border-bottom-color: white;
    }

    /* Modal */
    .modal-overlay {
      position: fixed;
      inset: 0;
      background: rgba(0, 0, 0, 0.97);
      backdrop-filter: blur(30px);
      z-index: 100;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 1rem;
      opacity: 0;
      visibility: hidden;
      transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .modal-overlay.active {
      opacity: 1;
      visibility: visible;
    }

    .modal-content {
      background: linear-gradient(145deg, #0a0a0a, #080808);
      border: 1px solid var(--accent);
      width: 100%;
      max-width: 900px;
      max-height: 90vh;
      overflow-y: auto;
      position: relative;
      box-shadow: 
        0 0 100px rgba(20, 153, 84, 0.2),
        0 25px 50px rgba(0,0,0,0.5);
      transform: scale(0.9) translateY(30px);
      transition: transform 0.5s cubic-bezier(0.4, 0, 0.2, 1);
      border-radius: 16px;
    }

    .modal-overlay.active .modal-content {
      transform: scale(1) translateY(0);
    }

    .modal-content::before {
      content: "";
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: repeating-linear-gradient(
        0deg,
        transparent,
        transparent 2px,
        rgba(20, 153, 84, 0.03) 2px,
        rgba(20, 153, 84, 0.03) 4px
      );
      pointer-events: none;
      z-index: 10;
    }

    .data-section {
      padding-bottom: 2rem;
      margin-bottom: 2rem;
      border-bottom: 1px solid rgba(255, 255, 255, 0.05);
    }

    .data-section:last-child {
      border-bottom: none;
      margin-bottom: 0;
      padding-bottom: 0;
    }

    .data-body-text {
      font-size: 1rem;
      line-height: 2;
      color: #d1d5db;
      margin-top: 0.5rem;
      text-align: justify;
    }

    .label-event { color: #34d399; font-weight: 700; }
    .label-impact { color: #60a5fa; font-weight: 700; }
    .label-link { color: #fbbf24; font-weight: 700; }
    .label-source { color: #f87171; font-weight: 500; font-size: 0.9em; }

    .modal-table {
      width: 100%;
      border-collapse: collapse;
      margin: 1.5rem 0;
      font-size: 0.9rem;
      border: 1px solid rgba(255,255,255,0.1);
      border-radius: 8px;
      overflow: hidden;
    }

    .modal-table th {
      background: linear-gradient(180deg, rgba(20, 153, 84, 0.3), rgba(20, 153, 84, 0.1));
      color: var(--accent);
      font-weight: 700;
      padding: 0.75rem 0.5rem;
      border: 1px solid rgba(255,255,255,0.05);
      text-align: center;
    }

    .modal-table td {
      padding: 0.75rem 0.5rem;
      border: 1px solid rgba(255,255,255,0.05);
      vertical-align: top;
      color: #d1d5db;
    }

    .modal-table tr:hover td {
      background: rgba(255, 255, 255, 0.03);
    }

    /* Scrollbar */
    ::-webkit-scrollbar { width: 6px; }
    ::-webkit-scrollbar-track { background: var(--bg); }
    ::-webkit-scrollbar-thumb { 
      background: linear-gradient(180deg, var(--accent), var(--accent-red)); 
      border-radius: 3px;
    }

    /* Animations */
    .fade-in { 
      animation: fadeIn 1s ease forwards; 
    }

    @keyframes fadeIn { 
      from { opacity: 0; transform: translateY(40px); } 
      to { opacity: 1; transform: translateY(0); } 
    }

    .stagger-item { 
      opacity: 0; 
      animation: fadeIn 0.6s ease forwards; 
    }

    .pulse-glow {
      animation: pulseGlow 2s ease-in-out infinite;
    }

    @keyframes pulseGlow {
      0%, 100% { 
        box-shadow: 0 0 20px rgba(20, 153, 84, 0.3);
      }
      50% { 
        box-shadow: 0 0 40px rgba(20, 153, 84, 0.6);
      }
    }

    .neon-text { text-shadow: 0 0 10px rgba(20, 153, 84, 0.6); }
    .neon-gold { text-shadow: 0 0 20px rgba(212, 175, 55, 0.6); }
    .neon-purple { text-shadow: 0 0 20px rgba(138, 43, 226, 0.6); }
    .neon-blue { text-shadow: 0 0 20px rgba(37, 99, 235, 0.6); }
    .neon-red { text-shadow: 0 0 20px rgba(228, 49, 43, 0.6); }

    /* Hero Badge */
    .hero-badge {
      position: relative;
      overflow: hidden;
    }

    .hero-badge::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(20, 153, 84, 0.3), transparent);
      animation: shimmer 3s infinite;
    }

    @keyframes shimmer {
      0% { left: -100%; }
      100% { left: 100%; }
    }

    /* Section Headers */
    .section-header {
      position: relative;
    }

    .section-header::after {
      content: '';
      position: absolute;
      bottom: -10px;
      left: 50%;
      transform: translateX(-50%);
      width: 60px;
      height: 3px;
      background: linear-gradient(90deg, transparent, var(--accent), transparent);
    }
  </style>
</head>
<body>

  <!-- Palestine Flag Top Bar -->
  <div class="palestine-gradient"></div>

  <!-- Animated Background -->
  <div class="bg-animation"></div>
  <div class="keffiyeh-pattern"></div>
  <div class="bg-grid"></div>

  <!-- Floating Particles -->
  <div class="particles-container" id="particles"></div>

  <!-- Buy Me a Coffee Button -->
  <div class="coffee-button" onclick="openBTCModal()">
    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <path d="M17 8h1a4 4 0 1 1 0 8h-1"/>
      <path d="M3 8h14v9a4 4 0 0 1-4 4H7a4 4 0 0 1-4-4Z"/>
      <line x1="6" y1="2" x2="6" y2="4"/>
      <line x1="10" y1="2" x2="10" y2="4"/>
      <line x1="14" y1="2" x2="14" y2="4"/>
    </svg>
    <span>Buy me a coffee</span>
  </div>

  <!-- BTC Modal -->
  <div id="btcModal" class="btc-modal-overlay" onclick="closeBTCModalOnBackdrop(event)">
    <div class="btc-modal-content" onclick="event.stopPropagation()">
      <button class="close-btc-modal" onclick="closeBTCModal()">×</button>
      <h2 class="text-2xl font-black mb-2" style="color: var(--accent-gold);">Support the Project</h2>
      <p class="text-gray-400 mb-6 text-sm">Bitcoin address for donations</p>
      
      <div class="btc-address-box" id="btcAddress">
        bc1qs642vuwxtwn5z926uuhnc6t33u42csdhes09c4
      </div>
      
      <button class="copy-btn" onclick="copyBTC()">
        Copy Address
      </button>
    </div>
  </div>

  <!-- News Ticker -->
  <div class="ticker-wrap">
    <div class="ticker">
      <span class="ticker-item" style="color: var(--accent);">SYSTEM ONLINE</span>
      <span class="ticker-item" style="color: var(--accent-red);">RESISTANCE CONTINUES</span>
      <span class="ticker-item" style="color: var(--accent-gold);">FROM THE RIVER TO THE SEA</span>
      <span class="ticker-item" style="color: var(--accent);">PALESTINE WILL BE FREE</span>
      <span class="ticker-item" style="color: white;">FREE PALESTINE</span>
      <span class="ticker-item" style="color: var(--accent-red);">JUSTICE FOR ALL</span>
      <span class="ticker-item" style="color: var(--accent);">LIBERATION IS NEAR</span>
      <span class="ticker-item" style="color: var(--accent-gold);">THE TRUTH PREVAILS</span>
    </div>
  </div>

  <!-- Flag Stripe Bottom -->
  <div class="flag-stripe"></div>

  <div class="min-h-screen px-4 py-24 md:px-8 lg:px-16">
    
    <!-- Hero Header -->
    <header class="max-w-7xl mx-auto mb-24 fade-in">
      <div class="flex flex-col items-center text-center">
        
        <!-- Hero Badge -->
        <div class="hero-badge inline-flex items-center gap-3 px-8 py-3 border border-[var(--accent)] rounded-full text-[var(--accent)] text-xs mb-12 bg-[rgba(20,153,84,0.05)] backdrop-blur-sm">
          <span class="w-2 h-2 bg-[var(--accent-red)] rounded-full animate-pulse shadow-[0_0_15px_var(--accent-red)]"></span>
          <span class="tracking-widest font-bold">وثيقة تفاعلية متجددة</span>
          <span class="w-2 h-2 bg-[var(--accent)] rounded-full animate-pulse shadow-[0_0_15px_var(--accent)]"></span>
        </div>

        <!-- Glitch Title -->
        <div class="glitch-wrapper mb-8">
          <h1 class="glitch-text" data-text="تاريخ الدول العربية">تاريخ الدول العربية</h1>
        </div>
        
        <!-- Subtitle -->
        <p class="text-lg md:text-xl text-[var(--muted)] max-w-3xl mb-10 leading-relaxed">
          مواقف الدول العربية من القضية الفلسطينية والكيان الصهيوني 
          <span class="text-white font-bold">حتى عام 2026</span>
        </p>

        <!-- Free Palestine Badge -->
        <div class="flex items-center gap-3 px-6 py-3 bg-gradient-to-r from-[rgba(20,153,84,0.2)] via-[rgba(228,49,43,0.2)] to-[rgba(20,153,84,0.2)] rounded-full border border-[var(--accent)] pulse-glow">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"></polygon>
          </svg>
          <span class="font-black text-white tracking-wider">FREE PALESTINE</span>
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"></polygon>
          </svg>
        </div>
      </div>
    </header>

    <!-- Main Content -->
    <main id="app-container" class="max-w-7xl mx-auto space-y-20">
      <div class="text-center text-[var(--muted)] py-20">
        <div class="inline-flex items-center gap-3">
          <div class="w-3 h-3 border-2 border-[var(--accent)] border-t-transparent rounded-full animate-spin"></div>
          <span>جاري تحميل البيانات...</span>
        </div>
      </div>
    </main>

    <!-- Palestine Section -->
    <section id="palestine-section" class="max-w-7xl mx-auto fade-in hidden">
      <div class="text-center mb-12 section-header">
        <div class="inline-flex items-center gap-3 px-8 py-3 bg-black border border-[var(--accent-gold)] text-[var(--accent-gold)] text-xs mb-6 rounded-full">
          <span class="w-2 h-2 bg-[var(--accent-red)] rounded-full animate-pulse"></span>
          SPECIAL DOSSIER
          <span class="w-2 h-2 bg-[var(--accent)] rounded-full animate-pulse"></span>
        </div>
        <h2 class="text-4xl md:text-5xl font-black text-[var(--accent-gold)] neon-gold">فلسطين</h2>
        <p class="text-[var(--muted)] text-sm mt-4 tracking-wider">The Land • The People • The Resistance</p>
      </div>
      <div class="palestine-section">
        <div class="p-8">
          <div id="palestine-grid" class="grid grid-cols-1 gap-6"></div>
        </div>
      </div>
    </section>

    <!-- Sovereignty Section -->
    <section id="sovereignty-section" class="max-w-7xl mx-auto fade-in hidden">
      <div class="text-center mb-12 section-header">
        <div class="inline-flex items-center gap-3 px-8 py-3 bg-black border border-[var(--accent-purple)] text-[var(--accent-purple)] text-xs mb-6 rounded-full relative overflow-hidden group">
          <span class="absolute inset-0 bg-gradient-to-r from-purple-900/0 via-purple-700/20 to-purple-900/0 translate-x-[-100%] group-hover:translate-x-[100%] transition-transform duration-1000"></span>
          <span class="w-2 h-2 bg-[var(--accent-red)] rounded-full animate-pulse"></span>
          POLITICAL ANALYSIS
          <span class="w-2 h-2 bg-[var(--accent-purple)] rounded-full animate-pulse"></span>
        </div>
        <h2 class="text-4xl md:text-5xl font-black relative">
          <span class="absolute -inset-2 bg-gradient-to-r from-purple-600 to-red-600 blur-2xl opacity-30"></span>
          <span class="relative text-[var(--accent-purple)] neon-purple">السيادة المخطوفة</span>
        </h2>
        <p class="text-[var(--muted)] text-sm mt-4">
          <span class="inline-block px-4 py-2 bg-purple-900/20 border border-purple-700/30 rounded-full text-purple-300 text-xs">
            When Independence is Traded for Survival
          </span>
        </p>
      </div>
      <div class="sovereignty-section">
        <div class="p-8">
          <div id="sovereignty-grid" class="grid grid-cols-1 md:grid-cols-2 gap-6"></div>
        </div>
      </div>
    </section>

    <!-- External Actors Section (America & ISIS) -->
    <section id="external-section" class="max-w-7xl mx-auto fade-in hidden">
      <div class="text-center mb-12 section-header">
        <div class="inline-flex items-center gap-3 px-8 py-3 bg-black border border-gray-500 text-gray-400 text-xs mb-6 rounded-full">
          <span class="w-2 h-2 bg-gray-400 rounded-full animate-pulse"></span>
          EXTERNAL ACTORS
          <span class="w-2 h-2 bg-gray-400 rounded-full animate-pulse"></span>
        </div>
        <h2 class="text-4xl md:text-5xl font-black text-gray-300">الكيانات المؤثرة</h2>
        <p class="text-[var(--muted)] text-sm mt-4">أدوات خارجية وتأثيرها على المنطقة</p>
      </div>
      <div class="external-section">
        <div class="p-8">
          <div id="external-grid" class="grid grid-cols-1 md:grid-cols-2 gap-6"></div>
        </div>
      </div>
    </section>

    <!-- Evidence Section -->
    <section class="max-w-7xl mx-auto fade-in">
      <div class="text-center mb-12 section-header">
        <div class="inline-flex items-center gap-3 px-8 py-3 bg-black border border-[var(--accent-blue)] text-[var(--accent-blue)] text-xs mb-6 rounded-full">
          <span class="w-2 h-2 bg-[var(--accent-red)] rounded-full animate-pulse"></span>
          VISUAL EVIDENCE DATABASE
          <span class="w-2 h-2 bg-[var(--accent-blue)] rounded-full animate-pulse"></span>
        </div>
        <h2 class="text-4xl md:text-5xl font-black text-[var(--accent-blue)] neon-blue">وثائق الأدلة المرئية</h2>
        <p class="text-[var(--muted)] text-sm mt-4 max-w-2xl mx-auto">قاعدة بيانات شاملة: الأدلة البصرية لجرائم الحرب في غزة</p>
      </div>
      <div class="evidence-section">
        <div class="p-8">
          <div class="overflow-x-auto">
            <table class="evidence-table">
              <thead>
                <tr>
                  <th>العنوان</th>
                  <th>المصدر</th>
                  <th>الرابط</th>
                  <th>المحتوى</th>
                  <th>النوع</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td class="font-bold">قاعدة فيديوهات الجنود</td>
                  <td>Al Jazeera</td>
                  <td><a href="https://www.aljazeera.com/news/longform/2025/4/16/israeli-soldiers-filmed-themselves-destroying-gaza-see-the-video-evidence" target="_blank">aljazeera.com</a></td>
                  <td>آلاف المقاطع التي صورها الجنود الإسرائيليون بأنفسهم توثق تدمير المنازل وقتل المدنيين</td>
                  <td><span class="px-2 py-1 bg-red-900/30 text-red-400 rounded text-xs">فيديو + صور</span></td>
                </tr>
                <tr>
                  <td class="font-bold">قناة فيديوهات بتسيلم</td>
                  <td>B'Tselem</td>
                  <td><a href="https://www.btselem.org/video-channel/all" target="_blank">btselem.org</a></td>
                  <td>أرشيف فيديوهات يوثق انتهاكات الاحتلال في الضفة الغربية وقطاع غزة</td>
                  <td><span class="px-2 py-1 bg-green-900/30 text-green-400 rounded text-xs">فيديو + شهادات</span></td>
                </tr>
                <tr>
                  <td class="font-bold">استهداف الطفلة آمنة</td>
                  <td>Euro-Med Monitor</td>
                  <td><a href="https://euromedmonitor.org/en/article/6832/" target="_blank">euromedmonitor.org</a></td>
                  <td>فيديو يوثق استهداف طائرة مسيرة للطفلة آمنة (11 سنة) بصاروخ</td>
                  <td><span class="px-2 py-1 bg-yellow-900/30 text-yellow-400 rounded text-xs">تحقيق ميداني</span></td>
                </tr>
                <tr>
                  <td class="font-bold">مركز حقوق الإنسان</td>
                  <td>PCHR</td>
                  <td><a href="https://pchrgaza.org/category/video/" target="_blank">pchrgaza.org</a></td>
                  <td>فيديوهات وتقارير توثق جرائم الإبادة الجماعية</td>
                  <td><span class="px-2 py-1 bg-purple-900/30 text-purple-400 rounded text-xs">تقارير + شهادات</span></td>
                </tr>
                <tr>
                  <td class="font-bold">إحصاءات قرى فلسطين 1945</td>
                  <td>Wikipedia</td>
                  <td><a href="https://en.wikipedia.org/wiki/Village_Statistics,_1945" target="_blank">wikipedia.org</a></td>
                  <td>مسح بريطاني يوثق أسماء القرى الفلسطينية وتوزيع السكان</td>
                  <td><span class="px-2 py-1 bg-blue-900/30 text-blue-400 rounded text-xs">وثائق تاريخية</span></td>
                </tr>
                <tr>
                  <td class="font-bold">قتل الأطفال أثناء وقف النار</td>
                  <td>UNICEF</td>
                  <td><a href="https://www.unicef.org.uk/press-releases/during-gazas-ceasefire-children-keep-being-killed/" target="_blank">unicef.org.uk</a></td>
                  <td>بيان رسمي يؤكد مقتل أكثر من 100 طفل منذ وقف إطلاق النار</td>
                  <td><span class="px-2 py-1 bg-red-900/30 text-red-400 rounded text-xs">بيان رسمي</span></td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </section>

    <!-- Footer -->
    <footer class="max-w-7xl mx-auto mt-24 mb-16 pt-10 border-t border-[var(--border)] text-center">
      <div class="flex justify-center items-center gap-4 mb-6">
        <div class="w-16 h-1 bg-gradient-to-r from-transparent to-[var(--accent)]"></div>
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="text-[var(--accent-red)]">
          <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path>
        </svg>
        <div class="w-16 h-1 bg-gradient-to-l from-transparent to-[var(--accent)]"></div>
      </div>
      <p class="text-[var(--muted)] text-xs uppercase tracking-[0.3em] font-bold">Freedom For Humanity | Freedom For Palestine</p>
    </footer>
  </div>

  <!-- Detail Modal -->
  <div id="detail-modal" class="modal-overlay" onclick="closeModalOnBackdrop(event)">
    <div class="modal-content" onclick="event.stopPropagation()">
      <div id="modal-body" class="relative"></div>
    </div>
  </div>

  <script>
    // ==========================================
    // DATA (Embedded for demonstration - can be moved to data.js)
    // ==========================================
    
    const levels = {
      1: { title: "المحور الأول: دول الاندماج العضوي (التحالف الوجودي)", desc: "تطبيع كامل – علاقات دبلوماسية وعسكرية واقتصادية مفتوحة" },
      2: { title: "المحور الثاني: دول الارتهان الجغرافي (تبعية القسر والديون)", desc: "علاقات مفروضة بفعل الضغوط والمعاهدات" },
      3: { title: "المحور الثالث: دول التنسيق الوظيفي (تطبيع الظل والمال)", desc: "تعاون في مجالات محدودة (طاقة، استخبارات، موانئ)" },
      4: { title: "المحور الرابع: دول الحصانة الشعبية (خندق الرفض القانوني)", desc: "موقف رسمي رافض، مقاطعة سياسية واقتصادية" },
      5: { title: "المحور الخامس: دول الصدام والسيادة (محور المواجهة المفتوحة)", desc: "دعم المقاومة، مواجهة عسكرية مفتوحة" }
    };

    const countriesData = [
      // ===== المستوى 1 (مثال) =====
      {
        id: 1,
        name: "الإمارات العربية المتحدة",
        level: 1,
        subtitle: "الشريك الاستراتيجي الأوثق",
        events: `أحداث التطبيع الإماراتي مع إسرائيل
1. اتفاقية أبراهام (2020)
الحدث: تطبيع العلاقات الدبلوماسية والاقتصادية والأمنية مع الكيان الصهيوني.

الأثر على العرب: كسر الحاجز النفسي والسياسي، فتح الباب لتطبيع دول خليجية أخرى.

التفاصيل: تم التوقيع في البيت الأبيض بحضور ترامب ونتنياهو.
`
      },
      {
        id: 2,
        name: "البحرين",
        level: 1,
        subtitle: "التطبيع الخليجي الثاني",
        events: `انضمام البحرين لاتفاقية أبراهام
الحدث: توقيع اتفاقية سلام مع إسرائيل بعد الإمارات مباشرة.

الأثر على العرب: تعزيز المحور الموالي للغرب في مواجهة إيران.`
      },

      // ===== المستوى 5 (إيران مع لبنان وسوريا) =====
      {
        id: 10,
        name: "لبنان",
        level: 5,
        subtitle: "جبهة المقاومة الجنوبية",
        events: `دور لبنان في الصراع
1. حرب تموز 2006
الحدث: انتصار حزب الله في مواجهة الجيش الإسرائيلي.

الأثر على العرب: تغير موازين الردع في المنطقة.`
      },
      {
        id: 11,
        name: "سوريا",
        level: 5,
        subtitle: "سورية الصمود والتحدي",
        events: `الموقف السوري
1. رفض التطبيع المستمر
الحدث: رفض سوريا لأي علاقات مع الكيان الصهيوني دعماً للقضية الفلسطينية.`
      },
      // === إيران (المضافة حديثاً) ===
      {
        id: 50,
        name: "إيران",
        level: 5,
        subtitle: "محور الدعم والمقاومة",
        events: `مواقف إيران من القضية الفلسطينية والكيان الصهيوني
1. الثورة الإسلامية (1979)
الحدث: قطع العلاقات مع إسرائيل وسحب السفير وتسليم السفارة الإسرائيلية في طهران للفلسطينيين.

التفاصيل: تحول الموقف الإيراني من حليف لإسرائيل في عهد الشاه إلى عدو وجودي لها.

الأثر على العرب: تأسيس محور مقاومة جديد في المنطقة.

2. الدعم العسكري للمقاومة
الحدث: تزويد حزب الله وحماس والجهاد الإسلامي بالتمويل والسلاح والتدريب.

الأثر على العرب: تغير موازين القوى في مواجهة الكيان الصهيوني.

3. برنامج الصواريخ الباليستية
الحدث: تطوير ترسانة صاروخية قادرة على الوصول لعمق الكيان.

التفاصيل: ردع إسرائيل عن ضرب إيران مباشرة لسنوات.`
      },

      // ===== فلسطين (قسم خاص) =====
      {
        id: 100,
        name: "فلسطين",
        subtitle: "The Core of the Cause",
        events: `ملف القضية الفلسطينية
1. النكبة (1948)
الحدث: تهجير أكثر من 700 ألف فلسطيني وتدمير أكثر من 500 قرية.

2. الانتفاضات والصمود
الحدث: انتفاضة الحجارة (1987) والانتفاضة الثانية (2000).`
      },

      // ===== السيادة المخطوفة (قسم خاص) =====
      {
        id: 101,
        name: "السيادة المخطوفة",
        subtitle: "ثمن السلام: استقلال أم تبعية؟",
        events: `تحليل السياسات الإقليمية
1. معاهدات السلام المنقوصة
الحدث: كامب ديفيد مع مصر وأوسلو مع الفلسطينيين.

الأثر: سلام بارد وتعاون أمني مقابل استقلال شكلي.`
      },

      // ===== الكيانات المؤثرة (أمريكا وداعش) =====
      {
        id: 200,
        name: "أمريكا",
        subtitle: "أمريكا من دولة عظمى إلى أداة تنفيذ صهيونية",
        events: `الدور الأمريكي في دعم الكيان الصهيوني
1. الاعتراف بالقدس عاصمة (2018)
الحدث: نقل السفارة الأمريكية إلى القدس.

الأثر على العرب: ضربة لصالح القانون الدولي وقرارات الأمم المتحدة.

2. صفقة القرن (2020)
الحدث: خطة أمريكية لتصفية القضية الفلسطينية.

التفاصيل: محاولة شرعنة الاستيطان وضم الأراضي.

3. الفيتو المتواصل
الحدث: استخدام الولايات المتحدة لحق النقض (الفيتو) عشرات المرات لحماية إسرائيل في مجلس الأمن.

الرابط: غير محدد`
      },
      {
        id: 201,
        name: "داعش",
        subtitle: "أداة التفكيك والتدمير",
        events: `دور داعش في المنطقة
1. الظهور في العراق وسوريا (2014)
الحدث: السيطرة على مساحات واسعة وإعلان "الخلافة".

الأثر على العرب: تشتيت الجيوش العربية وصرف الانتباه عن القضية الفلسطينية.

2. عدم استهداف إسرائيل
الحدث: لم تسجل أي عملية هجومية جادة لداعش ضد الكيان الصهيوني رغم قربها من الحدود.

التفاصيل: تقارير استخباراتية تشير إلى علاقات غير مباشرة وتحالف مصالح غير معلن.

3. تفكيك الدول العربية
الحدث: تدمير البنى التحتية في العراق وسوريا وليبيا.

الأثر: إضعاف الدول القومية لصالح تفتيت المنطقة.`
      }
    ];


    // ==========================================
    // LOGIC
    // ==========================================

    // Initialize Particles
    (function initParticles() {
      const container = document.getElementById('particles');
      const colors = ['green', 'red', 'gold'];
      
      for (let i = 0; i < 30; i++) {
        const particle = document.createElement('div');
        particle.className = `particle ${colors[Math.floor(Math.random() * colors.length)]}`;
        
        const size = Math.random() * 6 + 2;
        particle.style.width = `${size}px`;
        particle.style.height = `${size}px`;
        particle.style.left = `${Math.random() * 100}%`;
        particle.style.animationDuration = `${Math.random() * 20 + 10}s`;
        particle.style.animationDelay = `${Math.random() * 20}s`;
        
        container.appendChild(particle);
      }
    })();

    // Main App
    (function() {
      // Check if data exists
      if (typeof levels === 'undefined' || typeof countriesData === 'undefined') {
        document.getElementById('app-container').innerHTML = `
          <div class="text-center text-red-500 p-10 border border-red-500/30 bg-red-500/5 rounded-2xl">
            <h3 class="font-bold text-xl mb-3">خطأ في تحميل البيانات</h3>
            <p class="text-[var(--muted)]">تأكد من وجود ملف البيانات.</p>
          </div>`;
        return;
      }

      function renderApp() {
        const container = document.getElementById('app-container');
        container.innerHTML = '';

        // Render Levels 1-5
        for (let i = 1; i <= 5; i++) {
          const levelInfo = levels[i];
          const levelCountries = countriesData.filter(c => c.level === i);
          if (levelCountries.length === 0) continue;

          const section = document.createElement('section');
          section.className = `level-section level-${i} fade-in`;
          section.style.animationDelay = `${i * 0.2}s`;

          section.innerHTML = `
            <div class="p-8 border-b border-[var(--border)] flex flex-col md:flex-row md:items-center justify-between gap-4 bg-[rgba(255,255,255,0.02)]">
              <div>
                <h2 class="text-2xl md:text-3xl font-black tracking-tight">${levelInfo.title}</h2>
                <p class="text-sm text-[var(--muted)] mt-2 tracking-wide">${levelInfo.desc}</p>
              </div>
              <span class="px-5 py-2 text-xs font-bold tracking-widest rounded-full" style="color: ${getLevelColor(i, 'hex')}; border: 1px solid ${getLevelColor(i, 'hex')};">
                ${levelCountries.length} دول
              </span>
            </div>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 p-6">
              ${renderCountryCards(levelCountries)}
            </div>
          `;
          container.appendChild(section);
        }

        // Render Special Sections
        renderSpecialSection('palestine', 'palestine-section', 'palestine-grid', 'palestine-card');
        renderSpecialSection('sovereignty', 'sovereignty-section', 'sovereignty-grid', 'sovereignty-card');
        // NEW: Render External Actors (America, ISIS)
        renderSpecialSection('external', 'external-section', 'external-grid', 'external-card');

        animateItems();
      }

      function renderCountryCards(countries) {
        return countries.map((country, index) => `
          <div class="country-card stagger-item" onclick="openModal(${country.id})" role="button" tabindex="0" style="animation-delay: ${index * 0.1}s">
            <div class="flex justify-between items-start mb-4">
              <h3 class="text-xl font-black">${country.name}</h3>
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" class="opacity-30">
                <polyline points="15 18 9 12 15 6"></polyline>
              </svg>
            </div>
            ${country.subtitle ? `<p class="text-sm text-[var(--accent)] mb-4 font-medium tracking-wide">${country.subtitle}</p>` : ''}
            <div class="flex justify-between items-center mt-auto pt-5 border-t border-[var(--border)]">
              <span class="text-xs text-[var(--muted)] uppercase tracking-widest">ملف تفاعلي</span>
              <span class="flex items-center gap-2 text-xs font-bold text-[var(--accent)]">
                <span class="w-2 h-2 bg-[var(--accent)] rounded-full animate-pulse"></span>
                نشط
              </span>
            </div>
          </div>
        `).join('');
      }

      function renderSpecialSection(type, sectionId, gridId, cardClass) {
        let items = [];
        if (type === 'palestine') {
          items = countriesData.filter(c => c.id === 100);
        } else if (type === 'sovereignty') {
          items = countriesData.filter(c => c.id === 101);
        } else if (type === 'external') {
          // Filter for America and ISIS
          items = countriesData.filter(c => c.id === 200 || c.id === 201);
        }

        const sectionContainer = document.getElementById(sectionId);
        const gridContainer = document.getElementById(gridId);

        if (items.length > 0) {
          sectionContainer.classList.remove('hidden');
          
          let cardColorStyle = '';
          if (type === 'palestine') cardColorStyle = 'color: var(--accent-gold); text-shadow: 0 0 30px rgba(212,175,55,0.5);';
          else if (type === 'sovereignty') cardColorStyle = 'color: var(--accent-purple); text-shadow: 0 0 30px rgba(138,43,226,0.5);';
          else if (type === 'external') cardColorStyle = 'color: #9ca3af; text-shadow: 0 0 20px rgba(156,163,175,0.3);';

          gridContainer.innerHTML = items.map(item => `
            <div class="${cardClass} stagger-item" onclick="openModal(${item.id})" role="button" tabindex="0">
              <h3 class="text-3xl font-black mb-3" style="${cardColorStyle}">${item.name}</h3>
              ${item.subtitle ? `<p class="text-base text-gray-400 mb-6">${item.subtitle}</p>` : ''}
              <p class="text-xs text-[var(--muted)] uppercase tracking-widest">اضغط لفتح الملف التفاعلي</p>
            </div>
          `).join('');
        } else {
          sectionContainer.classList.add('hidden');
        }
      }

      function getLevelColor(level, type) {
        const colors = {
          1: { hex: '#059669', rgb: '5, 150, 105' },
          2: { hex: '#0891b2', rgb: '8, 145, 178' },
          3: { hex: '#d97706', rgb: '217, 119, 6' },
          4: { hex: '#2563eb', rgb: '37, 99, 235' },
          5: { hex: '#dc2626', rgb: '220, 38, 38' },
          100: { hex: '#D4AF37', rgb: '212, 175, 55' },
          101: { hex: '#8A2BE2', rgb: '138, 43, 226' }
        };
        return colors[level] ? colors[level][type] : '#ffffff';
      }

      function animateItems() {
        const items = document.querySelectorAll('.stagger-item');
        items.forEach((item, index) => {
          item.style.animationDelay = `${index * 0.08 + 0.3}s`;
        });
      }

      window.openModal = function(id) {
        const country = countriesData.find(c => c.id === id);
        if (!country) return;

        const modal = document.getElementById('detail-modal');
        const body = document.getElementById('modal-body');
        
        // Determine color
        let levelColor = '#149954';
        if (country.level) levelColor = getLevelColor(country.level, 'hex');
        else if (country.id === 100) levelColor = '#D4AF37';
        else if (country.id === 101) levelColor = '#8A2BE2';
        else if (country.id === 200 || country.id === 201) levelColor = '#6b7280';

        let eventsHtml = '';
        if (country.events && country.events.trim()) {
          eventsHtml = formatContent(country.events);
        } else {
          eventsHtml = '<p class="text-[var(--muted)] italic text-center py-16">لا توجد بيانات متاحة</p>';
        }

        body.innerHTML = `
          <button onclick="closeModal()" class="absolute top-5 left-5 z-20 w-12 h-12 flex items-center justify-center bg-black border border-[var(--accent-red)] text-[var(--accent-red)] hover:bg-[var(--accent-red)] hover:text-black transition-all text-xs tracking-widest rounded-full" aria-label="Close">ESC</button>
          <div class="p-10 md:p-14">
            <div class="mb-10 border-b border-[var(--border)] pb-8">
              <div class="flex items-center gap-3 mb-3">
                <span class="w-3 h-3 rounded-full animate-pulse" style="background: ${levelColor}; box-shadow: 0 0 20px ${levelColor}"></span>
                <span class="text-xs font-bold uppercase tracking-[0.2em]" style="color: ${levelColor}">
                  ${country.level ? (levels[country.level] ? levels[country.level].title.split(':')[0] : 'ملف خاص') : 'كيان مؤثر'}
                </span>
              </div>
              <h2 class="text-4xl md:text-5xl font-black mb-3">${country.name}</h2>
              ${country.subtitle ? `<p class="text-xl neon-text">${country.subtitle}</p>` : ''}
            </div>
            <div class="space-y-0">${eventsHtml}</div>
          </div>
        `;

        modal.classList.add('active');
        document.body.style.overflow = 'hidden';
      };

      window.closeModal = function() {
        document.getElementById('detail-modal').classList.remove('active');
        document.body.style.overflow = '';
      };

      window.closeModalOnBackdrop = function(e) {
        if (e.target.id === 'detail-modal') closeModal();
      };

      document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape') {
          closeModal();
          closeBTCModal();
        }
      });

      function formatContent(text) {
        const lines = text.split('\n').map(l => l.trimEnd());
        let result = '';
        let currentIndex = 0;

        function processPlainText(t) {
          let processed = t.replace(/\n/g, '<br>');
          processed = processed.replace(/الحدث:/g, '<br><span class="label-event">الحدث:</span>');
          processed = processed.replace(/الأثر على العرب:/g, '<br><span class="label-impact">الأثر على العرب:</span>');
          processed = processed.replace(/الرابط:/g, '<br><span class="label-source">الرابط:</span>');
          processed = processed.replace(/التفاصيل:/g, '<br><span class="label-link">التفاصيل:</span>');
          if (processed.startsWith('<br>')) processed = processed.substring(4);
          return `<div class="data-section"><div class="data-body-text">${processed}</div></div>`;
        }

        while (currentIndex < lines.length) {
          let tableStart = -1;
          for (let i = currentIndex; i < lines.length - 1; i++) {
            const line1 = lines[i];
            const line2 = lines[i + 1];
            if (line1 && line2 && 
                (line1.match(/\t/g) || []).length >= 2 && 
                (line2.match(/\t/g) || []).length >= 2) {
              tableStart = i;
              break;
            }
          }

          if (tableStart === -1) {
            const remainingLines = lines.slice(currentIndex).filter(l => l.trim() !== '');
            if (remainingLines.length > 0) {
              const remainingText = remainingLines.join('\n');
              result += processPlainText(remainingText);
            }
            break;
          }

          if (tableStart > currentIndex) {
            const beforeLines = lines.slice(currentIndex, tableStart).filter(l => l.trim() !== '');
            if (beforeLines.length > 0) {
              const beforeText = beforeLines.join('\n');
              result += processPlainText(beforeText);
            }
          }

          let tableEnd = tableStart;
          while (tableEnd < lines.length && (lines[tableEnd].match(/\t/g) || []).length >= 2) {
            tableEnd++;
          }

          const tableLines = lines.slice(tableStart, tableEnd).filter(l => l.trim() !== '');
          if (tableLines.length > 0) {
            let tableHtml = '<table class="modal-table">';
            let isFirstRow = true;
            for (let line of tableLines) {
              const cols = line.split('\t').map(c => c.trim());
              if (cols.length < 2) continue;
              tableHtml += '<tr>';
              for (let col of cols) {
                if (isFirstRow) {
                  tableHtml += `<th>${col}</th>`;
                } else {
                  tableHtml += `<td>${col}</td>`;
                }
              }
              tableHtml += '</tr>';
              isFirstRow = false;
            }
            tableHtml += '</table>';
            result += tableHtml;
          }

          currentIndex = tableEnd;
        }

        return result;
      }

      if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', renderApp);
      } else {
        renderApp();
      }
    })();

    // BTC Modal Functions
    window.openBTCModal = function() {
      document.getElementById('btcModal').classList.add('active');
    };

    window.closeBTCModal = function() {
      document.getElementById('btcModal').classList.remove('active');
    };

    window.closeBTCModalOnBackdrop = function(e) {
      if (e.target.id === 'btcModal') closeBTCModal();
    };

    window.copyBTC = function() {
      const btcAddress = "bc1qs642vuwxtwn5z926uuhnc6t33u42csdhes09c4";
      
      if (navigator.clipboard && navigator.clipboard.writeText) {
        navigator.clipboard.writeText(btcAddress);
      } else {
        const tempInput = document.createElement('input');
        tempInput.value = btcAddress;
        document.body.appendChild(tempInput);
        tempInput.select();
        tempInput.setSelectionRange(0, 99999);
        document.execCommand('copy');
        document.body.removeChild(tempInput);
      }
      
      const notification = document.createElement('div');
      notification.className = 'copy-notification';
      notification.innerHTML = '<span style="margin-right: 8px;">✓</span> تم نسخ عنوان البيتكوين!';
      document.body.appendChild(notification);
      
      setTimeout(() => notification.remove(), 2000);
      setTimeout(() => closeBTCModal(), 800);
    };
  </script>
</body>
</html>
